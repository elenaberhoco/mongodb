
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Premières requêtes en MongoDB &#8212; MongoDB : notes de cours</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2. Attributs de type liste" href="02_listes.html" />
    <link rel="prev" title="MongoDB : Notes de cours" href="00_intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      <h1 class="site-logo" id="site-title">MongoDB : notes de cours</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="00_intro.html">
   MongoDB : Notes de cours
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Chapitres
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   1. Premières requêtes en MongoDB
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_listes.html">
   2. Attributs de type liste
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_dates.html">
   3. Attributs de type date
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="04_index.html">
   4. Les index
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="05_agreg.html">
   5. Les requêtes d’agrégation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="06_modif.html">
   6. Les requêtes de modification
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="07_scripts.html">
   7. Effectuer des requêtes depuis des programmes Python ou R
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="07_scripts_py.html">
     7.1. Requêtes depuis Python :
     <code class="docutils literal notranslate">
      <span class="pre">
       pymongo
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="07_scripts_R.html">
     7.2. Requêtes depuis R :
     <code class="docutils literal notranslate">
      <span class="pre">
       mongolite
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Annexes
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="app_exemple.html">
   Annexe A : Exemple de fichier source
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="app_git.html">
   Annexe B : Utilisation de
   <code class="docutils literal notranslate">
    <span class="pre">
     git
    </span>
   </code>
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/content/01_find.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/01_find.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/rtavenar/mongo_book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/rtavenar/mongo_book/issues/new?title=Issue%20on%20page%20%2Fcontent/01_find.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/rtavenar/mongo_book/main?urlpath=tree/docs/content/01_find.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-mongodb">
   1.1. Introduction à MongoDB
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-name-find-a-requetes-d-interrogation-et-de-filtrage-des-donnees">
   1.2.
   <a name="find">
   </a>
   Requêtes d’interrogation et de filtrage des données
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#syntaxe-d-interrogation-de-donnees-sans-et-avec-condition">
     1.2.1. Syntaxe d’interrogation de données sans et avec condition
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poser-une-condition-sur-une-cle-de-sous-document">
     1.2.2. Poser une condition sur une clé de sous-document
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projection-des-donnees">
     1.2.3. Projection des données
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-name-operateurs-a-requetes-plus-complexes-en-utilisant-des-operateurs">
   1.3.
   <a name="operateurs">
   </a>
   Requêtes plus complexes en utilisant des opérateurs
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operateurs-de-comparaison">
     1.3.1. Opérateurs de comparaison
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#operateurs-logiques">
     1.3.2. Opérateurs logiques
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#and-logique">
       1.3.2.1.
       <code class="docutils literal notranslate">
        <span class="pre">
         and
        </span>
       </code>
       logique
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#or-logique">
       1.3.2.2.
       <code class="docutils literal notranslate">
        <span class="pre">
         or
        </span>
       </code>
       logique
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#nor-logique">
       1.3.2.3.
       <code class="docutils literal notranslate">
        <span class="pre">
         nor
        </span>
       </code>
       logique
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#not-logique">
       1.3.2.4.
       <code class="docutils literal notranslate">
        <span class="pre">
         not
        </span>
       </code>
       logique
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#a-name-methodes-a-methodes-utiles-pour-des-requetes-en-mongodb">
   1.4.
   <a name="methodes">
   </a>
   Méthodes utiles pour des requêtes en MongoDB
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connaitre-la-liste-des-collections-dans-une-base-de-donnees">
     1.4.1. Connaître la liste des collections dans une base de données
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#valeurs-distinctes-d-un-champ-la-methode-distinct">
     1.4.2. Valeurs distinctes d’un champ : la méthode
     <code class="docutils literal notranslate">
      <span class="pre">
       distinct
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compter-le-nombre-d-elements-la-methode-count">
     1.4.3. Compter le nombre d’éléments : la méthode
     <code class="docutils literal notranslate">
      <span class="pre">
       count
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trier-la-recuperation-des-documents-la-methode-sort">
     1.4.4. Trier la récupération des documents : la méthode
     <code class="docutils literal notranslate">
      <span class="pre">
       sort
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#limiter-la-recuperation-des-documents-la-methode-limit">
     1.4.5. Limiter la récupération des documents : la méthode
     <code class="docutils literal notranslate">
      <span class="pre">
       limit
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pour-conclure-ce-chapitre">
   1.5. Pour conclure ce chapitre
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-name-resume-a-fiche-resume-pour-bien-demarrer-en-mongodb">
     1.5.1.
     <a name="resume">
     </a>
     Fiche “résumé” pour bien démarrer en MongoDB
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-name-quiz-a-quiz-premieres-requetes-en-mongodb-a-vous-de-jouer">
     1.5.2.
     <a name="quiz">
     </a>
     Quiz “Premières requêtes en MongoDB” : À vous de jouer !
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="premieres-requetes-en-mongodb">
<h1><span class="section-number">1. </span>Premières requêtes en MongoDB<a class="headerlink" href="#premieres-requetes-en-mongodb" title="Permalink to this headline">¶</a></h1>
<p>Auteurs/trices : <strong>Julie FRANCOISE, Manon MAHEO et Valentin PENISSON</strong></p>
<hr class="docutils" />
<div class="section" id="introduction-a-mongodb">
<h2><span class="section-number">1.1. </span>Introduction à MongoDB<a class="headerlink" href="#introduction-a-mongodb" title="Permalink to this headline">¶</a></h2>
<p>Dans un <strong>système de base de données relationnelles</strong> <em>(comme les bases de données SQL)</em>, les données sont stockées par <strong>ligne</strong> <em>(appelées n-uplets)</em> dans des <strong>tables</strong> <em>(également appelées relations)</em>. Le modèle de données relationnel est un modèle <strong>très structuré</strong>, comportant des <strong>attributs typés</strong> <em>(les colonnes/attributs des tables ont un type précis qu’il soit numérique, alphanumérique ou temporel)</em> et des <strong>contraintes d’intégrité</strong> <em>(comme par exemple celle de l’unicité des valeurs de la clé primaire, la clé primaire étant un ensemble d’attributs permettant d’identifier de manière unique chaque n-uplet de la relation)</em>. Dans ce type de structure, il est nécessaire d’établir des <strong>jointures sur plusieurs tables</strong> afin de tirer des informations pertinentes sur la base de données.</p>
<p><strong>Dans MongoDB, les données sont modélisées sous forme de document sous un style JSON.</strong> On ne parle plus de tables, ni d’enregistrements mais de <strong>collections</strong> et de <strong>documents</strong>.</p>
<p>Une collection est un ensemble de documents, c’est l’équivalent d’une table dans un modèle relationnel. Un document est un enregistrement, une ligne dans le modèle de données relationnel. Ce système de gestion de données nous évite de faire des jointures de tables car <strong>toutes les informations nécessaires sont stockées dans un même document</strong>.</p>
<p>De plus, l’utilisation de bases de données NoSQL avec MongoDB nous permet plus de flexibilité en termes de mise à jour de la structure des données : aucun modèle n’est supposé sur les données, aucun attribut n’est obligatoire et il n’y a pas de type fixé pour un attribut.</p>
<p>Tout document appartient donc à une collection et a un champ appelé <code class="docutils literal notranslate"><span class="pre">_id</span></code> qui identifie le document dans la base de données. Prenons pour exemple la base de données <code class="docutils literal notranslate"><span class="pre">étudiants</span></code>. Voici un exemple de document :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&quot;56011920de43611b917d773d&quot;</span><span class="p">),</span>
    <span class="s2">&quot;nom&quot;</span> <span class="o">:</span> <span class="s2">&quot;Paul&quot;</span><span class="p">,</span>
    <span class="s2">&quot;notes&quot;</span> <span class="o">:</span> <span class="p">[</span> 
        <span class="mf">10.0</span><span class="p">,</span> 
        <span class="mf">12.0</span>
    <span class="p">],</span>
    <span class="s2">&quot;sexe&quot;</span> <span class="o">:</span> <span class="s2">&quot;M&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<blockquote>
<div><p>On a une <strong>association de clés et de valeurs</strong>, un document est équivalent aux objets JSON <em>(et ressemble aux dictionnaires en python)</em>. Dans ce document, on a accès au <strong>nom de l’étudiant</strong> par la clé <code class="docutils literal notranslate"><span class="pre">nom</span></code>, à <strong>ses notes</strong> par la clé <code class="docutils literal notranslate"><span class="pre">notes</span></code> <em>(attention, ici on a une <strong>liste de valeurs</strong> entre crochets, ce type d’attribut n’est par exemple pas disponible dans le modèle relationnel)</em> et à <strong>son sexe</strong> par la clé <code class="docutils literal notranslate"><span class="pre">sexe</span></code>. L’étudiant représenté par ce document, est identifié à l’aide d’une clé <code class="docutils literal notranslate"><span class="pre">_id</span></code>.</p>
</div></blockquote>
<p>Les clés se doivent d’être des <strong>chaînes de caractères</strong> mais nous pouvons avoir comme valeur de ces clés des <em>valeurs booléennes, des nombres, des chaînes de caractères, des dates ou des listes de valeurs</em> comme nous venons de le voir. Les clés et les valeurs sont <strong>sensibles à la casse et au type</strong>. Chaque clé doît être <strong>unique</strong>, il n’est pas possible d’avoir deux fois la même clé dans un document.</p>
<p><strong>Pour effectuer des requêtes sur une base de données MongoDB et filtrer les données, il est indispensable d’utiliser ces indications clés et valeurs.</strong></p>
<div class="admonition-avant-de-commencer-il-vous-faut admonition">
<p class="admonition-title">Avant de commencer, il vous faut :</p>
<p>Tout d’abord, il est nécessaire d’avoir installé un serveur comme par exemple le serveur <strong>MongoDB Atlas</strong> qui tourne en continu. Après avoir démarré le serveur, il vous faut lancer une connexion client, le <strong>client Robot 3T</strong> est idéal pour des requêtes en MongoDB. Il ne vous reste plus qu’à choisir une base de données ou en importer une et sélectionner <em>“Open Shell”</em> par clique droit sur la base pour faire vos requêtes !</p>
</div>
<p>Dans ce chapitre, nous étudierons dans un premier temps <a class="reference external" href="#find"><strong>comment interroger les données d’une base de données MongoDB avec la fonction find</strong></a>. Dans un second temps, nous regarderons comment effectuer des <a class="reference external" href="#operateurs">requêtes plus complexes, impliquant des <strong>opérateurs de comparaison</strong></a>. Quelques <a class="reference external" href="#methodes"><strong>méthodes utiles</strong></a> pour des requêtes en MongoDB, une <a class="reference external" href="#resume"><strong>fiche “résumé” des quelques points à retenir</strong></a> et un petit <a class="reference external" href="#quiz"><strong>quiz</strong></a> sont donnés à la fin de ce chapitre.</p>
</div>
<hr class="docutils" />
<div class="section" id="a-name-find-a-requetes-d-interrogation-et-de-filtrage-des-donnees">
<h2><span class="section-number">1.2. </span><a name="find"></a> Requêtes d’interrogation et de filtrage des données<a class="headerlink" href="#a-name-find-a-requetes-d-interrogation-et-de-filtrage-des-donnees" title="Permalink to this headline">¶</a></h2>
<p><strong>Pour récupérer des documents stockés dans une collection, il est nécessaire d’utiliser la fonction <code class="docutils literal notranslate"><span class="pre">find</span></code>.</strong></p>
<div class="admonition-remarque admonition">
<p class="admonition-title">Remarque</p>
<p>Toute commande sur une collection intitulée collectionName utilise le préfixe db : <code class="docutils literal notranslate"><span class="pre">db.collectionName</span></code>. Il suffit d’y associer la fonction souhaitée pour avoir un résultat. En l’occurence, ici la syntaxe de données d’interrogation MongoDB est <code class="docutils literal notranslate"><span class="pre">db.collectionName.find()</span></code>.</p>
</div>
<div class="section" id="syntaxe-d-interrogation-de-donnees-sans-et-avec-condition">
<h3><span class="section-number">1.2.1. </span>Syntaxe d’interrogation de données sans et avec condition<a class="headerlink" href="#syntaxe-d-interrogation-de-donnees-sans-et-avec-condition" title="Permalink to this headline">¶</a></h3>
<p>En MongoDB, lorsque l’on interroge les données, il existe deux types de requêtes simples, retournant respectivement <strong>toutes les occurences d’une collection</strong> ou <strong>seulement la première</strong>. Que l’on souhaite récupérer la première occurrence de la liste des résultats ou bien toute la liste des résultats, voici la syntaxe :</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Retourner toutes les occurences
d’une collection avec find()</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span> <span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">find</span><span class="p">()</span>
 <span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">find</span><span class="p">({})</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Retourner uniquement la première occurence
d’une collection avec findOne()</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">findOne</span><span class="p">()</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">findOne</span><span class="p">({})</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<div><p>À noter : Dans les deuxièmes propositions de chaque cas présenté ci-dessus, on a des accolades entre les parenthèses de la fonction. Ces accolades correspondent au <em>document masque</em>. Elles sont vides ce qui indique que nous ne posons pas de condition sur les documents à retourner.</p>
</div></blockquote>
<p>Au contraire, si l’on souhaite <strong>fixer des contraintes sur les documents à retourner</strong>, il suffit de passer en argument d’une de ces fonctions un document masque contenant les valeurs souhaitées. La requête suivante retourne tous les documents ayant un champ “x” dont la valeur est “y”.</p>
<p>La base de données food contient une collection NYfood qui recense un ensemble de restaurants américains et nous donne pour chaque restaurant des informations sur son quartier, son adresse, son type de cuisine, son nom, ses notes obtenues et son identifiant. Voici un extrait d’un document présent dans la collection NYfood :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;_id&quot;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&quot;6006c1882822efb1c9290f68&quot;</span><span class="p">),</span>
    <span class="s2">&quot;address&quot;</span> <span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;building&quot;</span> <span class="o">:</span> <span class="s2">&quot;265-15&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loc&quot;</span> <span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span> <span class="o">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
            <span class="s2">&quot;coordinates&quot;</span> <span class="o">:</span> <span class="p">[</span> 
                <span class="o">-</span><span class="mf">73.7032601</span><span class="p">,</span> 
                <span class="mf">40.7386417</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;street&quot;</span> <span class="o">:</span> <span class="s2">&quot;Hillside Avenue&quot;</span><span class="p">,</span>
        <span class="s2">&quot;zipcode&quot;</span> <span class="o">:</span> <span class="s2">&quot;11004&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;borough&quot;</span> <span class="o">:</span> <span class="s2">&quot;Queens&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cuisine&quot;</span> <span class="o">:</span> <span class="s2">&quot;Ice Cream, Gelato, Yogurt, Ices&quot;</span><span class="p">,</span>
    <span class="s2">&quot;grades&quot;</span> <span class="o">:</span> <span class="p">[</span> 
        <span class="p">{</span>
            <span class="s2">&quot;date&quot;</span> <span class="o">:</span> <span class="nx">ISODate</span><span class="p">(</span><span class="s2">&quot;2014-10-28T00:00:00.000Z&quot;</span><span class="p">),</span>
            <span class="s2">&quot;grade&quot;</span> <span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span> <span class="o">:</span> <span class="mf">9</span>
        <span class="p">},</span> 
        <span class="p">{</span>
            <span class="s2">&quot;date&quot;</span> <span class="o">:</span> <span class="nx">ISODate</span><span class="p">(</span><span class="s2">&quot;2013-09-18T00:00:00.000Z&quot;</span><span class="p">),</span>
            <span class="s2">&quot;grade&quot;</span> <span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span> <span class="o">:</span> <span class="mf">10</span>
        <span class="p">},</span> 
        <span class="p">{</span>
            <span class="s2">&quot;date&quot;</span> <span class="o">:</span> <span class="nx">ISODate</span><span class="p">(</span><span class="s2">&quot;2012-09-20T00:00:00.000Z&quot;</span><span class="p">),</span>
            <span class="s2">&quot;grade&quot;</span> <span class="o">:</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span>
            <span class="s2">&quot;score&quot;</span> <span class="o">:</span> <span class="mf">13</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;name&quot;</span> <span class="o">:</span> <span class="s2">&quot;Carvel Ice Cream&quot;</span><span class="p">,</span>
    <span class="s2">&quot;restaurant_id&quot;</span> <span class="o">:</span> <span class="s2">&quot;40361322&quot;</span>
<span class="p">}</span>   
    
</pre></div>
</div>
<p>En utilisant la syntaxe précédente, on recherche par exemple les documents de la collection NYfood correspondant à des <strong>boulangeries</strong> <em>(pour lesquels le champ “cuisine” vaut “Bakery”)</em> <strong>du Bronx</strong> <em>(pour lesquels le champ “borough” vaut “Bronx”)</em>. Dans cet exemple sur la base de données NYfood, la virgule représente un <strong>ET logique</strong> entre les contraintes.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="0779a803-1f09-4f52-8947-899b1d5eef6b" name="51e02511-374f-44d8-9643-a2ab91db20c9" type="radio">
</input><label class="tabbed-label" for="0779a803-1f09-4f52-8947-899b1d5eef6b">
Syntaxe</label><div class="tabbed-content docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">nomDeLaCollection</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;y&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<input id="003d80b3-7ead-49cf-bc89-d116c2675823" name="51e02511-374f-44d8-9643-a2ab91db20c9" type="radio">
</input><label class="tabbed-label" for="003d80b3-7ead-49cf-bc89-d116c2675823">
Exemple sur la base de données food</label><div class="tabbed-content docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;cuisine&quot;</span><span class="o">:</span> <span class="s2">&quot;Bakery&quot;</span><span class="p">,</span> <span class="s2">&quot;borough&quot;</span><span class="o">:</span> <span class="s2">&quot;Bronx&quot;</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<input id="14348710-2f25-4e01-a6b9-48a90ad0c570" name="51e02511-374f-44d8-9643-a2ab91db20c9" type="radio">
</input><label class="tabbed-label" for="14348710-2f25-4e01-a6b9-48a90ad0c570">
Parallèle avec le langage SQL</label><div class="tabbed-content docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">NYfood</span>
<span class="k">WHERE</span> <span class="n">cuisine</span> <span class="o">=</span> <span class="s1">&#39;Bakery&#39;</span> <span class="k">AND</span> <span class="n">borough</span> <span class="o">=</span> <span class="s1">&#39;Bronx&#39;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="poser-une-condition-sur-une-cle-de-sous-document">
<h3><span class="section-number">1.2.2. </span>Poser une condition sur une clé de sous-document<a class="headerlink" href="#poser-une-condition-sur-une-cle-de-sous-document" title="Permalink to this headline">¶</a></h3>
<p>Il se peut que pour une clé d’un document, comme par exemple l’adresse d’un restaurant dans la collection NYfood, nous disposons d’un <strong>sous-document</strong> contenant à la fois les coordonnées GPS et l’adresse postale. Plutôt qu’une liste de valeur comme présentée précédemment, nous avons comme valeur de la clé un nouveau document.</p>
<p>Si l’on souhaite <strong>poser une condition sur une clé ou plusieurs clés de sous-document</strong>, on utilise alors la syntaxe suivante :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;adress.zipcode&quot;</span><span class="o">:</span> <span class="s2">&quot;10462&quot;</span><span class="p">})</span>
</pre></div>
</div>
<p>où <code class="docutils literal notranslate"><span class="pre">adress</span></code> est le sous-document et <code class="docutils literal notranslate"><span class="pre">zipcode</span></code> la clé de ce dernier. Dans cet exemple, nous nous intéressons aux restaurants pour lesquels le zipcode est “10462”.</p>
</div>
<div class="section" id="projection-des-donnees">
<h3><span class="section-number">1.2.3. </span>Projection des données<a class="headerlink" href="#projection-des-donnees" title="Permalink to this headline">¶</a></h3>
<p>Les résultats obtenus jusqu’à présent sont parfois assez indigestes, notamment parce que toutes les clés sont retournées pour tous les documents. Il est possible de limiter cela en spécifiant les clés à retourner comme second argument de la fonction <code class="docutils literal notranslate"><span class="pre">find()</span></code>. On appelle ça une <strong>projection</strong>.</p>
<dl>
  <dt>Projection</dt>
  <dd>La projection permet de sélectionner les informations à renvoyer. Si, par exemple, je m’intéresse uniquement aux noms des boulangeries du Bronx, je vais     limiter les informations retournées en précisant comme deuxième argument de ma recherche find, la clé name avec la valeur true. C'est un argument optionnel !</dd>
</dl>
<div class="tabbed-set docutils">
<input checked="checked" id="6ee21b40-9d64-4ee8-9c96-beb896fd74eb" name="5c465078-2ca2-45f8-89a6-279ceaf705db" type="radio">
</input><label class="tabbed-label" for="6ee21b40-9d64-4ee8-9c96-beb896fd74eb">
Projection en MongoDB</label><div class="tabbed-content docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;cuisine&quot;</span><span class="o">:</span> <span class="s2">&quot;Bakery&quot;</span><span class="p">,</span> <span class="s2">&quot;borough&quot;</span><span class="o">:</span> <span class="s2">&quot;Bronx&quot;</span><span class="p">},</span> <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">})</span>
</pre></div>
</div>
</div>
<input id="8e047b78-a479-49ff-9388-375f32399333" name="5c465078-2ca2-45f8-89a6-279ceaf705db" type="radio">
</input><label class="tabbed-label" for="8e047b78-a479-49ff-9388-375f32399333">
Projection en SQL</label><div class="tabbed-content docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">name</span>
<span class="k">FROM</span> <span class="n">NYfood</span>
<span class="k">WHERE</span> <span class="n">cuisine</span> <span class="o">=</span> <span class="s1">&#39;Bakery&#39;</span> <span class="k">AND</span> <span class="s1">&#39;borough&#39;</span> <span class="o">=</span> <span class="s1">&#39;Bronx&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>C’est donc l’équivalent du <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">name</span></code> en SQL. Jusqu’ici, on utilisais le <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">*</span></code> <em>(pour all)</em> c’est-à-dire qu’on récupérait toutes les valeurs de chaque clé ou de chaque attribut.</p>
<div class="tip admonition">
<p class="admonition-title">Embellissez vos résultats !</p>
<p>Les résultats de la fonction <code class="docutils literal notranslate"><span class="pre">find()</span></code> peuvent apparaître désorganisés. MongoDB fournit <code class="docutils literal notranslate"><span class="pre">pretty()</span></code> qui affiche les résultats sous une forme plus lisible. La syntaxe est la suivante : <code class="docutils literal notranslate"><span class="pre">collectionName.find().pretty()</span></code> 😉</p>
</div>
<p>Pour plus de renseignements sur la <strong>fonction <code class="docutils literal notranslate"><span class="pre">find()</span></code></strong>, consultez la documentation MongoDB <a class="reference external" href="https://docs.mongodb.com/manual/reference/method/db.collection.find/">disponible ici</a>.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="a-name-operateurs-a-requetes-plus-complexes-en-utilisant-des-operateurs">
<h2><span class="section-number">1.3. </span><a name="operateurs"></a> Requêtes plus complexes en utilisant des opérateurs<a class="headerlink" href="#a-name-operateurs-a-requetes-plus-complexes-en-utilisant-des-operateurs" title="Permalink to this headline">¶</a></h2>
<p>Les opérateurs se séparent en deux grandes parties : les <strong>opérateurs de comparaison</strong> et les <strong>opérateurs logiques</strong>.</p>
<div class="admonition-remarque admonition">
<p class="admonition-title">Remarque</p>
<p>La syntaxe des requêtes avec des opérateurs de comparaison est la suivante : <code class="docutils literal notranslate"><span class="pre">db.nomDeLaCollection.find({&quot;x&quot;:</span> <span class="pre">{operateur:</span> <span class="pre">valeur}})</span></code>. Le sous-document contenant l’opératuer peut en fait contenir plusieurs opérateurs et ainsi ne seront retournées que les documents vérifiant toutes les conditions.</p>
</div>
<div class="section" id="operateurs-de-comparaison">
<h3><span class="section-number">1.3.1. </span>Opérateurs de comparaison<a class="headerlink" href="#operateurs-de-comparaison" title="Permalink to this headline">¶</a></h3>
<p>L’opérateur de comparaison permet de comparer deux élements entre eux. Le tableau suivant regroupe l’ensemble des opérateurs de comparaison :</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Opérateur logique</p></th>
<th class="head"><p>Mot clé en MongoDB</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>=</p></td>
<td><p>$eq</p></td>
</tr>
<tr class="row-odd"><td><p>négation</p></td>
<td><p>$ne</p></td>
</tr>
<tr class="row-even"><td><p>&lt;</p></td>
<td><p>$lt</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;</p></td>
<td><p>$gt</p></td>
</tr>
<tr class="row-even"><td><p>≤</p></td>
<td><p>$lte</p></td>
</tr>
<tr class="row-odd"><td><p>≥</p></td>
<td><p>$gte</p></td>
</tr>
<tr class="row-even"><td><p>∈</p></td>
<td><p>$in</p></td>
</tr>
<tr class="row-odd"><td><p>∉</p></td>
<td><p>$nin</p></td>
</tr>
<tr class="row-even"><td><p>clé existante</p></td>
<td><p>$exists</p></td>
</tr>
<tr class="row-odd"><td><p>|.|</p></td>
<td><p>$size</p></td>
</tr>
</tbody>
</table>
<p>Les opérateurs <code class="docutils literal notranslate"><span class="pre">$eq</span></code>, <code class="docutils literal notranslate"><span class="pre">$ne</span></code>, <code class="docutils literal notranslate"><span class="pre">$lt</span></code>, <code class="docutils literal notranslate"><span class="pre">$gt</span></code>, <code class="docutils literal notranslate"><span class="pre">$lte</span></code>, <code class="docutils literal notranslate"><span class="pre">$gte</span></code> s’utilisent de la même façon en MongoDB. Ces opérateurs comparent la valeur d’une variable à une valeur fixe (nombre, booléen, chaine de caractères…).</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">MongoDB</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">notes</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;notes&quot;</span><span class="o">:</span> <span class="p">{</span><span class="nx">$gte</span><span class="o">:</span> <span class="mf">13</span><span class="p">}})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">SQL</p>
</div>
<div class="card-body docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">notes</span>
<span class="k">WHERE</span> <span class="n">notes</span> <span class="o">&gt;=</span> <span class="mi">13</span> 
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>L’exemple ci-dessus affiche la liste des étudiants ayant au moins une note supérieure ou égale à 13.</p>
<p>Les opérateurs <code class="docutils literal notranslate"><span class="pre">$in</span></code> et <code class="docutils literal notranslate"><span class="pre">$nin</span></code> s’utilisent de la même façon en MongoDB. Ces opérateurs testent l’existence de la valeur d’une variable dans une liste. Sa façon de l’utiliser en MongoDB est la suivante :</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">MongoDB</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$in</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;chaine1&quot;</span><span class="p">,</span> <span class="s2">&quot;chaine2&quot;</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">SQL</p>
</div>
<div class="card-body docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">t</span>
<span class="k">WHERE</span> <span class="n">a</span> <span class="k">IN</span> <span class="p">(</span><span class="ss">&quot;chaine1&quot;</span><span class="p">,</span> <span class="ss">&quot;chaine2&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>L’opérateur <code class="docutils literal notranslate"><span class="pre">$exists</span></code> vérifie l’existence d’une clé dans un document. Sa syntaxe en MongoDB est :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$exists</span><span class="o">:</span> <span class="kc">true</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Cette requête renvera donc les documents ayant une clé <code class="docutils literal notranslate"><span class="pre">a</span></code>.</p>
<p>Enfin, l’opérateur <code class="docutils literal notranslate"><span class="pre">$size</span></code> permet des récuperer les documents avec des sous-documents d’une certaine taille. Sa syntaxe en MongoDB s’écrit comme suit :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="nx">$size</span><span class="o">:</span> <span class="mf">5</span><span class="p">}</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Le résultat obtenu est l’ensemble des documents pour lesquels la clé <code class="docutils literal notranslate"><span class="pre">a</span></code> est de taille <strong>5</strong>.</p>
</div>
<div class="section" id="operateurs-logiques">
<h3><span class="section-number">1.3.2. </span>Opérateurs logiques<a class="headerlink" href="#operateurs-logiques" title="Permalink to this headline">¶</a></h3>
<p>Les différents opérateurs logiques en MongoDB sont : <code class="docutils literal notranslate"><span class="pre">and</span></code>, <code class="docutils literal notranslate"><span class="pre">or</span></code>, <code class="docutils literal notranslate"><span class="pre">not</span></code> et <code class="docutils literal notranslate"><span class="pre">nor</span></code>. Ces opérateurs permettent de tester plusieurs conditions simultanément.</p>
<div class="section" id="and-logique">
<h4><span class="section-number">1.3.2.1. </span><code class="docutils literal notranslate"><span class="pre">and</span></code> logique<a class="headerlink" href="#and-logique" title="Permalink to this headline">¶</a></h4>
<p>L’opérateur <code class="docutils literal notranslate"><span class="pre">and</span></code> renvoie les documents qui remplissent l’ensemble des conditions. Pour faire une requête avec un <code class="docutils literal notranslate"><span class="pre">and</span></code> logique en MongoDB, il suffit de séparer par une virgule chaque condition. L’exemple ci-dessous nous montre l’équivalence entre MongoDB et le langage SQL :</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">MongoDB</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="o">:</span> <span class="mf">5</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">SQL</p>
</div>
<div class="card-body docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">t</span>
<span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Le résultat de la requête sera les documents validant les deux conditions suivantes : <code class="docutils literal notranslate"><span class="pre">a</span></code> = <strong>1</strong> et <code class="docutils literal notranslate"><span class="pre">b</span></code> = <strong>5</strong>.</p>
</div>
<div class="section" id="or-logique">
<h4><span class="section-number">1.3.2.2. </span><code class="docutils literal notranslate"><span class="pre">or</span></code> logique<a class="headerlink" href="#or-logique" title="Permalink to this headline">¶</a></h4>
<p>L’opérateur <code class="docutils literal notranslate"><span class="pre">or</span></code> permet de renvoyer les documents qui remplissent au moins un des conditions de la requête. Le <code class="docutils literal notranslate"><span class="pre">or</span></code> logique se construit de la manière suivane : <code class="docutils literal notranslate"><span class="pre">$or</span> <span class="pre">:</span> <span class="pre">[{condition</span> <span class="pre">1},</span> <span class="pre">...</span> <span class="pre">,</span> <span class="pre">{condition</span> <span class="pre">i}]</span></code>. Voici un exemple faisant le parralèle entre le langage MongoDB et le langage SQL :</p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">MongoDB</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">$or</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="mf">1</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="o">:</span> <span class="mf">5</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">SQL</p>
</div>
<div class="card-body docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="n">t</span>
<span class="k">WHERE</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">or</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>Le résultat de la requête sera les documents validant au moins un des deux conditions suivantes : <code class="docutils literal notranslate"><span class="pre">a</span></code> = <strong>1</strong> ou <code class="docutils literal notranslate"><span class="pre">b</span></code> = <strong>5</strong>.</p>
</div>
<div class="section" id="nor-logique">
<h4><span class="section-number">1.3.2.3. </span><code class="docutils literal notranslate"><span class="pre">nor</span></code> logique<a class="headerlink" href="#nor-logique" title="Permalink to this headline">¶</a></h4>
<p>L’opérateur <code class="docutils literal notranslate"><span class="pre">nor</span></code> permet de renvoyer les documents ne validant pas une liste de condition(s). Voici sa syntaxe qui est très semblable à celle de <code class="docutils literal notranslate"><span class="pre">or</span></code> :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">t</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span>
    <span class="p">{</span><span class="nx">$nor</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span><span class="s2">&quot;a&quot;</span><span class="o">:</span> <span class="mf">1</span><span class="p">},</span>
      <span class="p">{</span><span class="s2">&quot;b&quot;</span><span class="o">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Le résultat de cette requête sera l’ensemble des documents ne contenant pas la valeur <strong>1</strong> pour la variable <code class="docutils literal notranslate"><span class="pre">a</span></code> et <strong>“blue”</strong> pour la variable <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
</div>
<div class="section" id="not-logique">
<h4><span class="section-number">1.3.2.4. </span><code class="docutils literal notranslate"><span class="pre">not</span></code> logique<a class="headerlink" href="#not-logique" title="Permalink to this headline">¶</a></h4>
<p>Le <code class="docutils literal notranslate"><span class="pre">not</span></code> renvoie les documents qui ne remplissent pas les conditions qu’il contient. L’exemple suivant, sur la base NYfood, permet de renvoyer la liste des restaurants n’ayant aucune note “C”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">use</span> <span class="nx">food</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>switched to db food
</pre></div>
</div>
</div>
</div>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;grades.grade&quot;</span><span class="o">:</span> <span class="p">{</span><span class="nx">$not</span><span class="o">:</span> <span class="p">{</span><span class="nx">$eq</span><span class="o">:</span> <span class="s2">&quot;C&quot;</span><span class="p">}}})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbc8&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;1007&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.856077,
				40.848447
			]
		},
		&quot;street&quot; : &quot;Morris Park Ave&quot;,
		&quot;zipcode&quot; : &quot;10462&quot;
	},
	&quot;borough&quot; : &quot;Bronx&quot;,
	&quot;cuisine&quot; : &quot;Bakery&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-03-03T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 2
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-09-11T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 6
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-01-24T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 10
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-11-23T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 9
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-03-10T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;B&quot;,
			&quot;score&quot; : 14
		}
	],
	&quot;name&quot; : &quot;Morris Park Bake Shop&quot;,
	&quot;restaurant_id&quot; : &quot;30075445&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbc9&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;351&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.98513559999999,
				40.7676919
			]
		},
		&quot;street&quot; : &quot;West   57 Street&quot;,
		&quot;zipcode&quot; : &quot;10019&quot;
	},
	&quot;borough&quot; : &quot;Manhattan&quot;,
	&quot;cuisine&quot; : &quot;Irish&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-09-06T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 2
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-07-22T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 11
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-07-31T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-12-29T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		}
	],
	&quot;name&quot; : &quot;Dj Reynolds Pub And Restaurant&quot;,
	&quot;restaurant_id&quot; : &quot;30191841&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbca&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;2780&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.98241999999999,
				40.579505
			]
		},
		&quot;street&quot; : &quot;Stillwell Avenue&quot;,
		&quot;zipcode&quot; : &quot;11224&quot;
	},
	&quot;borough&quot; : &quot;Brooklyn&quot;,
	&quot;cuisine&quot; : &quot;American &quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-06-10T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 5
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-06-05T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 7
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-04-13T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-10-12T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		}
	],
	&quot;name&quot; : &quot;Riviera Caterer&quot;,
	&quot;restaurant_id&quot; : &quot;40356018&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbcb&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;469&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.961704,
				40.662942
			]
		},
		&quot;street&quot; : &quot;Flatbush Avenue&quot;,
		&quot;zipcode&quot; : &quot;11225&quot;
	},
	&quot;borough&quot; : &quot;Brooklyn&quot;,
	&quot;cuisine&quot; : &quot;Hamburgers&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-12-30T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 8
		},
		{
			&quot;date&quot; : ISODate(&quot;2014-07-01T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;B&quot;,
			&quot;score&quot; : 23
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-04-30T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-05-08T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		}
	],
	&quot;name&quot; : &quot;Wendy&#39;S&quot;,
	&quot;restaurant_id&quot; : &quot;30112340&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbcc&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;97-22&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.8601152,
				40.7311739
			]
		},
		&quot;street&quot; : &quot;63 Road&quot;,
		&quot;zipcode&quot; : &quot;11374&quot;
	},
	&quot;borough&quot; : &quot;Queens&quot;,
	&quot;cuisine&quot; : &quot;Jewish/Kosher&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-11-24T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;Z&quot;,
			&quot;score&quot; : 20
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-01-17T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 13
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-08-02T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 13
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-12-15T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;B&quot;,
			&quot;score&quot; : 25
		}
	],
	&quot;name&quot; : &quot;Tov Kosher Kitchen&quot;,
	&quot;restaurant_id&quot; : &quot;40356068&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbcd&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;8825&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.8803827,
				40.7643124
			]
		},
		&quot;street&quot; : &quot;Astoria Boulevard&quot;,
		&quot;zipcode&quot; : &quot;11369&quot;
	},
	&quot;borough&quot; : &quot;Queens&quot;,
	&quot;cuisine&quot; : &quot;American &quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-11-15T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;Z&quot;,
			&quot;score&quot; : 38
		},
		{
			&quot;date&quot; : ISODate(&quot;2014-05-02T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 10
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-03-02T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 7
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-02-10T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 13
		}
	],
	&quot;name&quot; : &quot;Brunos On The Boulevard&quot;,
	&quot;restaurant_id&quot; : &quot;40356151&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbce&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;2206&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-74.1377286,
				40.6119572
			]
		},
		&quot;street&quot; : &quot;Victory Boulevard&quot;,
		&quot;zipcode&quot; : &quot;10314&quot;
	},
	&quot;borough&quot; : &quot;Staten Island&quot;,
	&quot;cuisine&quot; : &quot;Jewish/Kosher&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-10-06T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 9
		},
		{
			&quot;date&quot; : ISODate(&quot;2014-05-20T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-04-04T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-01-24T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 9
		}
	],
	&quot;name&quot; : &quot;Kosher Island&quot;,
	&quot;restaurant_id&quot; : &quot;40356442&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbcf&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;7114&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.9068506,
				40.6199034
			]
		},
		&quot;street&quot; : &quot;Avenue U&quot;,
		&quot;zipcode&quot; : &quot;11234&quot;
	},
	&quot;borough&quot; : &quot;Brooklyn&quot;,
	&quot;cuisine&quot; : &quot;Delicatessen&quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-05-29T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 10
		},
		{
			&quot;date&quot; : ISODate(&quot;2014-01-14T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 10
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-08-03T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 8
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-07-18T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 10
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-03-09T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 13
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-10-14T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 9
		}
	],
	&quot;name&quot; : &quot;Wilken&#39;S Fine Food&quot;,
	&quot;restaurant_id&quot; : &quot;40356483&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbd0&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;6409&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-74.00528899999999,
				40.628886
			]
		},
		&quot;street&quot; : &quot;11 Avenue&quot;,
		&quot;zipcode&quot; : &quot;11219&quot;
	},
	&quot;borough&quot; : &quot;Brooklyn&quot;,
	&quot;cuisine&quot; : &quot;American &quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-07-18T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-07-30T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 12
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-02-13T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 11
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-08-16T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 2
		},
		{
			&quot;date&quot; : ISODate(&quot;2011-08-17T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 11
		}
	],
	&quot;name&quot; : &quot;Regina Caterers&quot;,
	&quot;restaurant_id&quot; : &quot;40356649&quot;
}
{
	&quot;_id&quot; : ObjectId(&quot;6086704a6021b46bfb4dbbd1&quot;),
	&quot;address&quot; : {
		&quot;building&quot; : &quot;2300&quot;,
		&quot;loc&quot; : {
			&quot;type&quot; : &quot;Point&quot;,
			&quot;coordinates&quot; : [
				-73.8786113,
				40.8502883
			]
		},
		&quot;street&quot; : &quot;Southern Boulevard&quot;,
		&quot;zipcode&quot; : &quot;10460&quot;
	},
	&quot;borough&quot; : &quot;Bronx&quot;,
	&quot;cuisine&quot; : &quot;American &quot;,
	&quot;grades&quot; : [
		{
			&quot;date&quot; : ISODate(&quot;2014-05-28T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 11
		},
		{
			&quot;date&quot; : ISODate(&quot;2013-06-19T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 4
		},
		{
			&quot;date&quot; : ISODate(&quot;2012-06-15T00:00:00Z&quot;),
			&quot;grade&quot; : &quot;A&quot;,
			&quot;score&quot; : 3
		}
	],
	&quot;name&quot; : &quot;Wild Asia&quot;,
	&quot;restaurant_id&quot; : &quot;40357217&quot;
}
Type &quot;it&quot; for more
</pre></div>
</div>
</div>
</div>
<p>Pour plus de renseignements sur <strong>les opérateurs</strong>, consultez la documentation MongoDB <a class="reference external" href="https://docs.mongodb.com/manual/reference/operator/query/">disponible à cette adresse</a>.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="a-name-methodes-a-methodes-utiles-pour-des-requetes-en-mongodb">
<h2><span class="section-number">1.4. </span><a name="methodes"></a> Méthodes utiles pour des requêtes en MongoDB<a class="headerlink" href="#a-name-methodes-a-methodes-utiles-pour-des-requetes-en-mongodb" title="Permalink to this headline">¶</a></h2>
<div class="section" id="connaitre-la-liste-des-collections-dans-une-base-de-donnees">
<h3><span class="section-number">1.4.1. </span>Connaître la liste des collections dans une base de données<a class="headerlink" href="#connaitre-la-liste-des-collections-dans-une-base-de-donnees" title="Permalink to this headline">¶</a></h3>
<p>Pour connaître la <strong>liste des collections</strong> contenues dans une base de données, on utilise la commande suivante sur la base de données considérée :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">getCollectionInfos</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="valeurs-distinctes-d-un-champ-la-methode-distinct">
<h3><span class="section-number">1.4.2. </span>Valeurs distinctes d’un champ : la méthode <code class="docutils literal notranslate"><span class="pre">distinct</span></code><a class="headerlink" href="#valeurs-distinctes-d-un-champ-la-methode-distinct" title="Permalink to this headline">¶</a></h3>
<p>La méthode <code class="docutils literal notranslate"><span class="pre">distinct</span></code> permet de renvoyer <strong>toutes les valeurs distinctes du champ spécifié</strong>. C’est l’équivalent du <code class="docutils literal notranslate"><span class="pre">SELECT</span> <span class="pre">DISTINCT</span></code> en SQL.
Par exemple, la requête suivante en MongoDB permet d’afficher la <strong>liste des notes attribuées à des restaurants du quartier « Manhattan » pour la collection NYfood.</strong></p>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Syntaxe et exemple en MongoDB</p>
</div>
<div class="card-body docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">distinct</span><span class="p">(</span><span class="nx">champ</span><span class="p">,</span> <span class="p">{...})</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">distinct</span><span class="p">(</span><span class="s2">&quot;grades.grade&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;borough&quot;</span><span class="o">:</span> <span class="s2">&quot;Manhattan&quot;</span><span class="p">})</span> 
</pre></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header docutils">
<p class="card-text">Équivalent de la syntaxe en SQL</p>
</div>
<div class="card-body docutils">
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="k">DISTINCT</span><span class="p">(</span><span class="n">champ</span><span class="p">)</span>
<span class="k">FROM</span> <span class="n">collectionName</span>
<span class="k">WHERE</span> <span class="p">...</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<blockquote>
<div><p>À noter : il n’y a pas d’équivalent en SQL pour l’exemple des notes attribuées aux restaurants du quartier “Manhattan” présenté ici puisque <strong>un attribut ne peut pas être une liste de valeurs en SQL</strong>.</p>
</div></blockquote>
</div>
<div class="section" id="compter-le-nombre-d-elements-la-methode-count">
<h3><span class="section-number">1.4.3. </span>Compter le nombre d’éléments : la méthode <code class="docutils literal notranslate"><span class="pre">count</span></code><a class="headerlink" href="#compter-le-nombre-d-elements-la-methode-count" title="Permalink to this headline">¶</a></h3>
<p>La méthode <code class="docutils literal notranslate"><span class="pre">count</span></code> permet de <strong>compter le nombre de documents dans une collection</strong>. On peut l’utiliser directement sur la collection de base pour connaître le nombre de documents dans la collection ou bien l’utiliser après avoir exécuter une requête puisque la méthode <code class="docutils literal notranslate"><span class="pre">count()</span></code> accepte un document masque elle aussi.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="5f781895-8031-462a-a388-55a3cd119c21" name="6743fb76-d209-4532-a04f-aefeecfd9743" type="radio">
</input><label class="tabbed-label" for="5f781895-8031-462a-a388-55a3cd119c21">
Sur une collection sans requête</label><div class="tabbed-content docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<input id="e3df95c0-50d8-4406-bfad-07feda2037d2" name="6743fb76-d209-4532-a04f-aefeecfd9743" type="radio">
</input><label class="tabbed-label" for="e3df95c0-50d8-4406-bfad-07feda2037d2">
Sur une collection après requête</label><div class="tabbed-content docutils">
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">NYfood</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="s2">&quot;cuisine&quot;</span><span class="o">:</span> <span class="s2">&quot;Bakery&quot;</span><span class="p">}).</span><span class="nx">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>Bien entendu, les résultats seront différents car nous n’avons pas le même nombre de documents avant et après un filtrage de données. Dans le premier exemple, on souhaite afficher le <strong>nombre de documents dans la collection NYfood</strong> tandis que dans le deuxième, on récupère le <strong>nombre de documents correspondant à des boulangeries</strong> <em>(pour lesquels le champ “cuisine” vaut “Bakery”)</em>.</p>
</div></blockquote>
</div>
<div class="section" id="trier-la-recuperation-des-documents-la-methode-sort">
<h3><span class="section-number">1.4.4. </span>Trier la récupération des documents : la méthode <code class="docutils literal notranslate"><span class="pre">sort</span></code><a class="headerlink" href="#trier-la-recuperation-des-documents-la-methode-sort" title="Permalink to this headline">¶</a></h3>
<p>La méthode <code class="docutils literal notranslate"><span class="pre">sort</span></code> sert à <strong>trier les documents de sortie</strong> à partir d’une ou plusieurs clés. Pour choisir l’ordre de tri, il suffit de mettre <code class="docutils literal notranslate"><span class="pre">1</span></code> pour trier dans un <strong>ordre croissant</strong> et <code class="docutils literal notranslate"><span class="pre">-1</span></code> pour trier dans un <strong>ordre décroissant</strong>.</p>
<p>Par exemple, pour trier les documents de sortie en fonction de la clé <code class="docutils literal notranslate"><span class="pre">key1</span></code> de façon croissante on utilisera la syntaxe suivante :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">sort</span><span class="p">(</span>
  <span class="p">{</span><span class="s2">&quot;key1&quot;</span> <span class="o">:</span> <span class="mf">1</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Il est également possible de faire un <strong>tri sur plusieurs clés</strong> :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">sort</span><span class="p">(</span>
  <span class="p">{</span><span class="s2">&quot;key1&quot;</span> <span class="o">:</span> <span class="mf">1</span><span class="p">,</span> <span class="s2">&quot;key2&quot;</span> <span class="o">:</span> <span class="o">-</span><span class="mf">1</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="limiter-la-recuperation-des-documents-la-methode-limit">
<h3><span class="section-number">1.4.5. </span>Limiter la récupération des documents : la méthode <code class="docutils literal notranslate"><span class="pre">limit</span></code><a class="headerlink" href="#limiter-la-recuperation-des-documents-la-methode-limit" title="Permalink to this headline">¶</a></h3>
<p>La méthode <code class="docutils literal notranslate"><span class="pre">limit</span></code> permet de <strong>limiter le nombre de documents renvoyés</strong>. Elle accepte les arguments numériques. Voici la syntaxe :</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">collectionName</span><span class="p">.</span><span class="nx">find</span><span class="p">({}).</span><span class="nx">limit</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="pour-conclure-ce-chapitre">
<h2><span class="section-number">1.5. </span>Pour conclure ce chapitre<a class="headerlink" href="#pour-conclure-ce-chapitre" title="Permalink to this headline">¶</a></h2>
<div class="section" id="a-name-resume-a-fiche-resume-pour-bien-demarrer-en-mongodb">
<h3><span class="section-number">1.5.1. </span><a name="resume"></a> Fiche “résumé” pour bien démarrer en MongoDB<a class="headerlink" href="#a-name-resume-a-fiche-resume-pour-bien-demarrer-en-mongodb" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Objectif</p></th>
<th class="head"><p>Syntaxe</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Récupérer toutes les occurrences de la collection</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({})</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Récupérer la première occurrence de la collection</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.findOne({})</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Filtrer les données</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({&quot;x&quot;:</span> <span class="pre">valeur})</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Limiter l’affichage des clés</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({},</span> <span class="pre">{&quot;key&quot;:</span> <span class="pre">true})</span> </code></p></td>
</tr>
<tr class="row-even"><td><p>Formater les documents de sortie</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).pretty()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Requêtes avec des opérateurs de comparaison</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({&quot;x&quot;:</span> <span class="pre">{operateur:</span> <span class="pre">valeur}})</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Trier les documents de sortie</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find().sort({&quot;key&quot;</span> <span class="pre">:</span> <span class="pre">1})</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Compter les documents de sortie</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).count()</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Limiter les documents de sortie</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).limit(2)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Valeurs distinctes d’un champ</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.distinct(champ,</span> <span class="pre">{})</span></code></p></td>
</tr>
</tbody>
</table>
<p><strong>Pour vous tester et être certain que vous avez bien compris, répondez aux questions du quiz ci-dessous.</strong></p>
</div>
<div class="section" id="a-name-quiz-a-quiz-premieres-requetes-en-mongodb-a-vous-de-jouer">
<h3><span class="section-number">1.5.2. </span><a name="quiz"></a> Quiz “Premières requêtes en MongoDB” : À vous de jouer !<a class="headerlink" href="#a-name-quiz-a-quiz-premieres-requetes-en-mongodb-a-vous-de-jouer" title="Permalink to this headline">¶</a></h3>
<p><strong>Qu’est-ce qui caractérise MongoDB ?</strong></p>
<ol class="simple">
<li><p>C’est un modèle orienté graphique</p></li>
<li><p>C’est un modèle orienté document</p></li>
<li><p>C’est un modèle structuré</p></li>
</ol>
<p><em>Réponse 2 : C’est un modèle orienté document.</em></p>
<p><strong>Que nous renvoie cette requête sur la collection <code class="docutils literal notranslate"><span class="pre">notes</span></code> de la base <code class="docutils literal notranslate"><span class="pre">etudiants</span></code> ?</strong></p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">notes</span><span class="p">.</span><span class="nx">find</span><span class="p">({},</span> <span class="p">{</span><span class="s2">&quot;nom&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="s2">&quot;_id&quot;</span><span class="o">:</span> <span class="kc">false</span><span class="p">})</span> 
</pre></div>
</div>
<ol class="simple">
<li><p>Affiche <strong>tout</strong> le contenu de la collection <code class="docutils literal notranslate"><span class="pre">notes</span></code></p></li>
<li><p>Les noms des étudiants de la base et la clé <code class="docutils literal notranslate"><span class="pre">_id</span></code> qui identifie chaque étudiant</p></li>
<li><p>Tous les noms des étudiants de la base, mais pas les autres clés</p></li>
</ol>
<p><em>Réponse 3 : L’argument <code class="docutils literal notranslate"><span class="pre">&quot;_id&quot;:</span> <span class="pre">false</span></code> permet de retirer l’affichage de la clé <code class="docutils literal notranslate"><span class="pre">id</span></code>. On ne récupère que le noms des étudiants de la base.</em></p>
<p><strong>Comment récupérer la liste des étudiants ayant obtenu exactement deux notes ?</strong></p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db.notes.find({&quot;notes&quot;:</span> <span class="pre">{$size:</span> <span class="pre">2}})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.notes.find({&quot;notes&quot;:</span> <span class="pre">{$exists:</span> <span class="pre">true}})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.notes.find({$or:</span> <span class="pre">[{&quot;notes&quot;:</span> <span class="pre">{$size:</span> <span class="pre">1}},{&quot;notes&quot;:</span> <span class="pre">{$size:</span> <span class="pre">2}}]})</span></code></p></li>
</ol>
<p><em>Réponse 1 : L’opérateur <code class="docutils literal notranslate"><span class="pre">$size</span></code> permet de prendre en compte la taille de la liste de valeurs, telle qu’une liste de notes. Ici on souhaite que la liste de notes soit précisement de taille 2.</em></p>
<p><strong>Quel opérateur permet de ne renvoyer que les documents qui ne vérifient aucune condition de la liste ?</strong></p>
<ol class="simple">
<li><p>L’opérateur <code class="docutils literal notranslate"><span class="pre">$eq</span></code></p></li>
<li><p>L’opérateur <code class="docutils literal notranslate"><span class="pre">$nor</span></code></p></li>
<li><p>L’opérateur <code class="docutils literal notranslate"><span class="pre">$gt</span></code></p></li>
</ol>
<p><em>Réponse 2 : L’opérateur <code class="docutils literal notranslate"><span class="pre">$nor</span></code> permet de ne renvoyer que les documents qui ne vérifient aucune condition de la liste.</em></p>
<p><strong>Quelle méthode ci-dessous ne fait pas partie du langage MongoDB ?</strong></p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).orderby({&quot;key&quot;</span> <span class="pre">:</span> <span class="pre">1})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).sort({&quot;key&quot;</span> <span class="pre">:</span> <span class="pre">1})</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">db.collectionName.find({}).limit(3)</span></code></p></li>
</ol>
<p><em>Réponse 1 : Bien que <code class="docutils literal notranslate"><span class="pre">ORDER</span> <span class="pre">BY</span></code> soit une instruction en SQL, ce n’est pas disponible pour les bases de données en MongoDB.</em></p>
<p>Afin que le langage MongoDB n’ait plus aucun secret pour vous, nous vous invitons à lire les <strong>chapitres suivants</strong> et à consultez la <a class="reference external" href="https://docs.mongodb.com">documentation MongoDB</a> !</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "imongo"
        },
        kernelOptions: {
            kernelName: "imongo",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'imongo'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="00_intro.html" title="previous page">MongoDB : Notes de cours</a>
    <a class='right-next' id="next-link" href="02_listes.html" title="next page"><span class="section-number">2. </span>Attributs de type liste</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Ouvrage collectif<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  None
  </body>
</html>